---

output: html_document
---
#Project Inferential Statistics - Week 4
###Carlos Monsalve

##Overview:
#####we're going to analyze the ToothGrowth data in the R datasets package


```{r}
setwd("~/Data Science/Inferential Statistics")
```

##package required:

```{r}
library(ggplot2)
library(dplyr)
```

##Dataset:

```{r}
library(datasets)
data(ToothGrowth)
```

##Basic Exploratory Analisys:

###Data:


```{r}
mean(ToothGrowth$len)
median(ToothGrowth$len)
max(ToothGrowth$len)
min(ToothGrowth$len)
sd(ToothGrowth$len)
range(ToothGrowth$len)
quantile(ToothGrowth$len, c(.025,.975)) ## alpha=5%
```

###Split Data by Dose

```{r}
stat<-split(ToothGrowth,ToothGrowth$dose)
count<-aggregate(. ~ dose, data=ToothGrowth, FUN=length)
sapply( stat, function(x) mean(x$len) )
sapply( stat, function(x) median(x$len) )
sapply( stat, function(x) sd(x$len) )
sapply( stat, function(x) range(x$len) )
```

###Plot:

```{r}
barplot((sapply( stat, function(x) sum(x$len))),col="green",xlab="dose",ylab="length",main="Analysis")
```

#####It seems like the dose matters

###Split Data by Supp

```{r}
stat2<-split(ToothGrowth,ToothGrowth$supp)
count<-aggregate(. ~ dose, data=ToothGrowth, FUN=length)
sapply( stat2, function(x) mean(x$len) )
sapply( stat2, function(x) median(x$len) )
sapply( stat2, function(x) sd(x$len) )
sapply( stat2, function(x) range(x$len) )
```

###Plot

```{r}
barplot((sapply( stat2, function(x) sum(x$len))),col="green",xlab="supp",ylab="length",main="Analysis")
```

#####It seems like the Supp matters

###Plot with all Variables

```{r}
ggplot(data=ToothGrowth, aes(x=as.factor(dose), y=len)) +
  geom_boxplot() +
  facet_grid(. ~ supp) +
  xlab("Dose") +
  ylab("Length") +
  guides(fill=guide_legend(title="Supplement type"))
```

#####Boxplot for Dose 2 and 1 under supp = 1 (OJ), doesn't show clear difference

##Summary

```{r}
summary(ToothGrowth)
str(ToothGrowth)
head(ToothGrowth) 
names(ToothGrowth)
```

##Confidence intervals and/or hypothesis tests to compare tooth growth by supp and dose

```{r}
ToothGrowth %>%
  group_by(supp,dose) %>%
  summarise(Q25th_len = quantile(len,0.25),
            Q50th_len = quantile(len,0.5),
            Q75th_len = quantile(len,0.75),
            avg_len = mean(len),            
            sd_len = sd(len)) -> data
data
```

###Set up the tests results with three doses (0.5,1,2) & 2 supp (OJ,VC)

```{r}
m1 <- c(13.25,22.70,26.06)
m2 <- c(7.98,16.17,26.14)
sd1 <- c(4.45,3.91,2.65)
sd2 <- c(2.74,2.51,4.79)
num1 <- c(20,20,20)
num2 <- c(20,20,20)
se <- sqrt(sd1*sd1/num1+sd2*sd2/num2)
error <- qt(0.975,df=pmin(num1,num2)-1)*se
left <- (m1-m2)-error
right <- (m1-m2)+error
left
right
```


#####Based on Conference Intervals for 2 Doses, we can't conclude is significantly different (-2.64,2.48). The other tests showed difference in Length 





